app.controller("bookstoreCtrl",["$scope","httpService","$timeout","Config",function($scope,httpService,$timeout,config){var page=1,loading=!1;$scope.book={},$scope.search=function(){page=1,$scope.loadBooks()},$scope.changeType=function(type){$scope.book.type=type,$scope.search()},$scope.$on("stateChangeSuccess",function(){$scope.loadBooks()}),$scope.loadBooks=function(){loading||(loading=!0,httpService.post("books/list",{bookName:$scope.book.bookName,type:$scope.book.type,page:page,pageSize:5}).success(function(d){0==d.data.length?$scope.noMoreItemsAvailable=!0:(page++,$scope.books=$scope.books.concat(d.data),angular.forEach($scope.books,function(d){d.imgPath=config.imgPrefix+d.imgPath,d.filePath=config.filePrefix+d.filePath})),loading=!1,$scope.$broadcast("scroll.infiniteScrollComplete")}))},$scope.books=[],$scope.noMoreItemsAvailable=!1,$scope.search()}]);