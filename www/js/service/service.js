"use strict";app.service("httpService",["$http","Config",function($http,configs){function getUrl(url){return url.startsWith("http")?url:configs.serverUrl+url}return{post:function(url,param,config){return url=getUrl(url),$http.post(url,$.param(param||{}),angular.extend({},{headers:{"Content-Type":"application/x-www-form-urlencoded"}},config))},get:function(url,config){return url=getUrl(url),$http.get(url,angular.extend({},{headers:{"Content-Type":"application/x-www-form-urlencoded"}},config))},put:function(url,param){return url=getUrl(url),$http.put(url,JSON.stringify(param),{headers:{"Content-Type":"application/json"}})},"delete":function(url){return url=getUrl(url),$http["delete"](url,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}}]),app.service("curUserService",["httpService","Config","$state",function(httpService,config,$state){var curUser={},rememberMe=!1,isLogined=!1;this.getIsLogined=function(){return isLogined},this.doLogin=function(params){var promise=httpService.post("/login/signin",params);promise.then(function(d){if(console.log(d),1!=d.data)return!1;var curUserReq=httpService.post("/user/"+params.userName);curUserReq.then(function(data){console.log(data.data),void 0!=data.data.imgPath&&""!=data.data.imgPath?data.data.imgPath=config.imgPrefix+data.data.imgPath:data.data.imgPath="img/thumbnail.jpg",curUser=data.data,isLogined=!0,rememberMe=params.rememberMe,$state.go("app.self.index")},function(data){console.log("获取用户信息失败"+data)})})},this.doLogout=function(){isLogined=!1,httpService.post("login/logout").success(function(d){ionic.Platform.exitApp()})},this.getIsLogined=function(){return isLogined},this.getCurUser=function(){return curUser},this.setCurUser=function(user){curUser=user},this.getRemeberMe=function(){return rememberMe}}]);